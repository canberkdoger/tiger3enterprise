SELECT 1 AS ISTASYON, 
       D1.BASLANGIC, 
       D1.BITIS, 
       CASE 
           WHEN D1.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D1.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D1.BASLANGIC, D1.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D1.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_1 D1 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D1.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D1.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D1.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D1.BASLANGIC, D1.BITIS)
      END >= 2

UNION ALL

SELECT 2 AS ISTASYON, 
       D2.BASLANGIC, 
       D2.BITIS, 
       CASE 
           WHEN D2.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D2.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D2.BASLANGIC, D2.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D2.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_2 D2 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D2.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D2.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D2.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D2.BASLANGIC, D2.BITIS)
      END >= 2

UNION ALL

SELECT 3 AS ISTASYON, 
       D3.BASLANGIC, 
       D3.BITIS, 
       CASE 
           WHEN D3.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D3.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D3.BASLANGIC, D3.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D3.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_3 D3 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D3.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D3.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D3.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D3.BASLANGIC, D3.BITIS)
      END >= 2

UNION ALL

SELECT 4 AS ISTASYON, 
       D4.BASLANGIC, 
       D4.BITIS, 
       CASE 
           WHEN D4.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D4.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D4.BASLANGIC, D4.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D4.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_4 D4 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D4.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D4.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D4.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D4.BASLANGIC, D4.BITIS)
      END >= 2

UNION ALL

SELECT 5 AS ISTASYON, 
       D5.BASLANGIC, 
       D5.BITIS, 
       CASE 
           WHEN D5.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D5.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D5.BASLANGIC, D5.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D5.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_5 D5 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D5.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D5.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D5.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D5.BASLANGIC, D5.BITIS)
      END >= 2

UNION ALL

SELECT 6 AS ISTASYON, 
       D6.BASLANGIC, 
       D6.BITIS, 
       CASE 
           WHEN D6.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D6.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D6.BASLANGIC, D6.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D6.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_6 D6 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D6.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D6.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D6.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D6.BASLANGIC, D6.BITIS)
      END >= 2

UNION ALL

SELECT 7 AS ISTASYON, 
       D7.BASLANGIC, 
       D7.BITIS, 
       CASE 
           WHEN D7.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D7.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D7.BASLANGIC, D7.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D7.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_7 D7 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D7.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D7.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D7.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D7.BASLANGIC, D7.BITIS)
      END >= 2

UNION ALL

SELECT 8 AS ISTASYON, 
       D8.BASLANGIC, 
       D8.BITIS, 
       CASE 
           WHEN D8.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D8.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D8.BASLANGIC, D8.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D8.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_8 D8 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D8.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D8.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D8.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D8.BASLANGIC, D8.BITIS)
      END >= 2

UNION ALL

SELECT 9 AS ISTASYON, 
       D9.BASLANGIC, 
       D9.BITIS, 
       CASE 
           WHEN D9.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D9.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D9.BASLANGIC, D9.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D9.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_9 D9 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D9.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D9.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D9.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D9.BASLANGIC, D9.BITIS)
      END >= 2

UNION ALL

SELECT 10 AS ISTASYON, 
       D10.BASLANGIC, 
       D10.BITIS, 
       CASE 
           WHEN D10.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D10.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D10.BASLANGIC, D10.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D10.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_10 D10 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D10.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D10.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D10.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D10.BASLANGIC, D10.BITIS)
      END >= 2
UNION ALL

SELECT 11 AS ISTASYON, 
       D11.BASLANGIC, 
       D11.BITIS, 
       CASE 
           WHEN D11.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D11.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D11.BASLANGIC, D11.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D11.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_11 D11 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D11.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D11.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D11.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D11.BASLANGIC, D11.BITIS)
      END >= 2

UNION ALL

SELECT 12 AS ISTASYON, 
       D12.BASLANGIC, 
       D12.BITIS, 
       CASE 
           WHEN D12.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D12.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D12.BASLANGIC, D12.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D12.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_12 D12 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D12.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D12.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D12.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D12.BASLANGIC, D12.BITIS)
      END >= 2

UNION ALL

SELECT 13 AS ISTASYON, 
       D13.BASLANGIC, 
       D13.BITIS, 
       CASE 
           WHEN D13.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D13.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D13.BASLANGIC, D13.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D13.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_13 D13 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D13.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D13.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D13.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D13.BASLANGIC, D13.BITIS)
      END >= 2

UNION ALL

SELECT 14 AS ISTASYON, 
       D14.BASLANGIC, 
       D14.BITIS, 
       CASE 
           WHEN D14.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D14.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D14.BASLANGIC, D14.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D14.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_14 D14 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D14.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D14.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D14.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D14.BASLANGIC, D14.BITIS)
      END >= 2

UNION ALL

SELECT 15 AS ISTASYON, 
       D15.BASLANGIC, 
       D15.BITIS, 
       CASE 
           WHEN D15.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D15.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D15.BASLANGIC, D15.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D15.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_15 D15 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D15.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D15.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D15.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D15.BASLANGIC, D15.BITIS)
      END >= 2

UNION ALL

SELECT 16 AS ISTASYON, 
       D16.BASLANGIC, 
       D16.BITIS, 
       CASE 
           WHEN D16.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D16.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D16.BASLANGIC, D16.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D16.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_16 D16 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D16.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D16.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D16.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D16.BASLANGIC, D16.BITIS)
      END >= 2

UNION ALL

SELECT 17 AS ISTASYON, 
       D17.BASLANGIC, 
       D17.BITIS, 
       CASE 
           WHEN D17.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D17.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D17.BASLANGIC, D17.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D17.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_17 D17 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D17.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D17.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D17.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D17.BASLANGIC, D17.BITIS)
      END >= 2

UNION ALL

SELECT 18 AS ISTASYON, 
       D18.BASLANGIC, 
       D18.BITIS, 
       CASE 
           WHEN D18.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D18.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D18.BASLANGIC, D18.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D18.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_18 D18 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D18.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D18.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D18.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D18.BASLANGIC, D18.BITIS)
      END >= 2

UNION ALL

SELECT 19 AS ISTASYON, 
       D19.BASLANGIC, 
       D19.BITIS, 
       CASE 
           WHEN D19.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D19.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D19.BASLANGIC, D19.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D19.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_19 D19 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D19.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D19.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D19.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D19.BASLANGIC, D19.BITIS)
      END >= 2

UNION ALL

SELECT 20 AS ISTASYON, 
       D20.BASLANGIC, 
       D20.BITIS, 
       CASE 
           WHEN D20.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D20.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D20.BASLANGIC, D20.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D20.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_20 D20 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D20.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D20.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D20.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D20.BASLANGIC, D20.BITIS)
      END >= 2

UNION ALL

SELECT 21 AS ISTASYON, 
       D21.BASLANGIC, 
       D21.BITIS, 
       CASE 
           WHEN D21.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D21.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D21.BASLANGIC, D21.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D21.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_21 D21 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D21.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D21.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D21.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D21.BASLANGIC, D21.BITIS)
      END >= 2

UNION ALL

SELECT 22 AS ISTASYON, 
       D22.BASLANGIC, 
       D22.BITIS, 
       CASE 
           WHEN D22.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D22.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D22.BASLANGIC, D22.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D22.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_22 D22 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D22.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D22.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D22.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D22.BASLANGIC, D22.BITIS)
      END >= 2

UNION ALL

SELECT 23 AS ISTASYON, 
       D23.BASLANGIC, 
       D23.BITIS, 
       CASE 
           WHEN D23.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D23.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D23.BASLANGIC, D23.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D23.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_23 D23 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D23.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D23.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D23.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D23.BASLANGIC, D23.BITIS)
      END >= 2

UNION ALL

SELECT 24 AS ISTASYON, 
       D24.BASLANGIC, 
       D24.BITIS, 
       CASE 
           WHEN D24.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D24.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D24.BASLANGIC, D24.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D24.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_24 D24 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D24.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D24.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D24.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D24.BASLANGIC, D24.BITIS)
      END >= 2

UNION ALL

SELECT 25 AS ISTASYON, 
       D25.BASLANGIC, 
       D25.BITIS, 
       CASE 
           WHEN D25.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D25.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D25.BASLANGIC, D25.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D25.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_25 D25 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D25.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D25.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D25.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D25.BASLANGIC, D25.BITIS)
      END >= 2

UNION ALL

SELECT 26 AS ISTASYON, 
       D26.BASLANGIC, 
       D26.BITIS, 
       CASE 
           WHEN D26.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D26.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D26.BASLANGIC, D26.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D26.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_26 D26 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D26.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D26.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D26.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D26.BASLANGIC, D26.BITIS)
      END >= 2

UNION ALL

SELECT 27 AS ISTASYON, 
       D27.BASLANGIC, 
       D27.BITIS, 
       CASE 
           WHEN D27.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D27.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D27.BASLANGIC, D27.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D27.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_27 D27 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D27.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D27.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D27.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D27.BASLANGIC, D27.BITIS)
      END >= 2

UNION ALL

SELECT 28 AS ISTASYON, 
       D28.BASLANGIC, 
       D28.BITIS, 
       CASE 
           WHEN D28.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D28.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D28.BASLANGIC, D28.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D28.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_28 D28 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D28.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D28.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D28.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D28.BASLANGIC, D28.BITIS)
      END >= 2

UNION ALL

SELECT 29 AS ISTASYON, 
       D29.BASLANGIC, 
       D29.BITIS, 
       CASE 
           WHEN D29.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D29.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D29.BASLANGIC, D29.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D29.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_29 D29 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D29.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D29.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D29.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D29.BASLANGIC, D29.BITIS)
      END >= 2

UNION ALL

SELECT 30 AS ISTASYON, 
       D30.BASLANGIC, 
       D30.BITIS, 
       CASE 
           WHEN D30.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D30.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D30.BASLANGIC, D30.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D30.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_30 D30 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D30.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D30.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D30.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D30.BASLANGIC, D30.BITIS)
      END >= 2
UNION ALL

SELECT 31 AS ISTASYON, 
       D31.BASLANGIC, 
       D31.BITIS, 
       CASE 
           WHEN D31.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D31.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D31.BASLANGIC, D31.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D31.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_31 D31 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D31.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D31.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D31.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D31.BASLANGIC, D31.BITIS)
      END >= 2

UNION ALL

SELECT 32 AS ISTASYON, 
       D32.BASLANGIC, 
       D32.BITIS, 
       CASE 
           WHEN D32.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D32.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D32.BASLANGIC, D32.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D32.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_32 D32 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D32.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D32.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D32.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D32.BASLANGIC, D32.BITIS)
      END >= 2

UNION ALL

SELECT 33 AS ISTASYON, 
       D33.BASLANGIC, 
       D33.BITIS, 
       CASE 
           WHEN D33.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D33.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D33.BASLANGIC, D33.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D33.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_33 D33 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D33.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D33.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D33.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D33.BASLANGIC, D33.BITIS)
      END >= 2

UNION ALL

SELECT 34 AS ISTASYON, 
       D34.BASLANGIC, 
       D34.BITIS, 
       CASE 
           WHEN D34.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D34.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D34.BASLANGIC, D34.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D34.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_34 D34 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D34.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D34.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D34.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D34.BASLANGIC, D34.BITIS)
      END >= 2

UNION ALL

SELECT 35 AS ISTASYON, 
       D35.BASLANGIC, 
       D35.BITIS, 
       CASE 
           WHEN D35.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D35.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D35.BASLANGIC, D35.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D35.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_35 D35 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D35.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D35.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D35.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D35.BASLANGIC, D35.BITIS)
      END >= 2

UNION ALL

SELECT 36 AS ISTASYON, 
       D36.BASLANGIC, 
       D36.BITIS, 
       CASE 
           WHEN D36.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D36.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D36.BASLANGIC, D36.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D36.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_36 D36 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D36.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D36.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D36.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D36.BASLANGIC, D36.BITIS)
      END >= 2

UNION ALL

SELECT 37 AS ISTASYON, 
       D37.BASLANGIC, 
       D37.BITIS, 
       CASE 
           WHEN D37.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D37.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D37.BASLANGIC, D37.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D37.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_37 D37 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D37.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D37.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D37.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D37.BASLANGIC, D37.BITIS)
      END >= 2

UNION ALL

SELECT 38 AS ISTASYON, 
       D38.BASLANGIC, 
       D38.BITIS, 
       CASE 
           WHEN D38.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D38.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D38.BASLANGIC, D38.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D38.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_38 D38 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D38.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D38.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D38.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D38.BASLANGIC, D38.BITIS)
      END >= 2

UNION ALL

SELECT 39 AS ISTASYON, 
       D39.BASLANGIC, 
       D39.BITIS, 
       CASE 
           WHEN D39.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D39.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D39.BASLANGIC, D39.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D39.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_39 D39 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D39.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D39.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D39.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D39.BASLANGIC, D39.BITIS)
      END >= 2

UNION ALL

SELECT 40 AS ISTASYON, 
       D40.BASLANGIC, 
       D40.BITIS, 
       CASE 
           WHEN D40.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D40.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D40.BASLANGIC, D40.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D40.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_40 D40 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D40.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D40.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D40.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D40.BASLANGIC, D40.BITIS)
      END >= 2
UNION ALL

SELECT 41 AS ISTASYON, 
       D41.BASLANGIC, 
       D41.BITIS, 
       CASE 
           WHEN D41.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D41.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D41.BASLANGIC, D41.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D41.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_41 D41 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D41.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D41.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D41.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D41.BASLANGIC, D41.BITIS)
      END >= 2

UNION ALL

SELECT 42 AS ISTASYON, 
       D42.BASLANGIC, 
       D42.BITIS, 
       CASE 
           WHEN D42.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D42.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D42.BASLANGIC, D42.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D42.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_42 D42 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D42.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D42.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D42.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D42.BASLANGIC, D42.BITIS)
      END >= 2

UNION ALL

SELECT 43 AS ISTASYON, 
       D43.BASLANGIC, 
       D43.BITIS, 
       CASE 
           WHEN D43.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D43.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D43.BASLANGIC, D43.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D43.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_43 D43 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D43.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D43.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D43.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D43.BASLANGIC, D43.BITIS)
      END >= 2

UNION ALL

SELECT 44 AS ISTASYON, 
       D44.BASLANGIC, 
       D44.BITIS, 
       CASE 
           WHEN D44.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D44.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D44.BASLANGIC, D44.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D44.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_44 D44 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D44.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D44.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D44.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D44.BASLANGIC, D44.BITIS)
      END >= 2

UNION ALL

SELECT 45 AS ISTASYON, 
       D45.BASLANGIC, 
       D45.BITIS, 
       CASE 
           WHEN D45.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D45.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D45.BASLANGIC, D45.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D45.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_45 D45 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D45.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D45.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D45.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D45.BASLANGIC, D45.BITIS)
      END >= 2

UNION ALL

SELECT 46 AS ISTASYON, 
       D46.BASLANGIC, 
       D46.BITIS, 
       CASE 
           WHEN D46.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D46.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D46.BASLANGIC, D46.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D46.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_46 D46 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D46.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D46.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D46.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D46.BASLANGIC, D46.BITIS)
      END >= 2

UNION ALL

SELECT 47 AS ISTASYON, 
       D47.BASLANGIC, 
       D47.BITIS, 
       CASE 
           WHEN D47.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D47.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D47.BASLANGIC, D47.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D47.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_47 D47 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D47.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D47.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D47.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D47.BASLANGIC, D47.BITIS)
      END >= 2

UNION ALL

SELECT 48 AS ISTASYON, 
       D48.BASLANGIC, 
       D48.BITIS, 
       CASE 
           WHEN D48.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D48.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D48.BASLANGIC, D48.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D48.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_48 D48 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D48.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D48.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D48.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D48.BASLANGIC, D48.BITIS)
      END >= 2

UNION ALL

SELECT 49 AS ISTASYON, 
       D49.BASLANGIC, 
       D49.BITIS, 
       CASE 
           WHEN D49.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D49.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D49.BASLANGIC, D49.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D49.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_49 D49 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D49.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D49.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D49.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D49.BASLANGIC, D49.BITIS)
      END >= 2

UNION ALL

SELECT 50 AS ISTASYON, 
       D50.BASLANGIC, 
       D50.BITIS, 
       CASE 
           WHEN D50.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D50.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D50.BASLANGIC, D50.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D50.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_50 D50 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D50.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D50.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D50.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D50.BASLANGIC, D50.BITIS)
      END >= 2
UNION ALL

SELECT 51 AS ISTASYON, 
       D51.BASLANGIC, 
       D51.BITIS, 
       CASE 
           WHEN D51.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D51.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D51.BASLANGIC, D51.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D51.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_51 D51 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D51.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D51.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D51.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D51.BASLANGIC, D51.BITIS)
      END >= 2

UNION ALL

SELECT 52 AS ISTASYON, 
       D52.BASLANGIC, 
       D52.BITIS, 
       CASE 
           WHEN D52.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D52.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D52.BASLANGIC, D52.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D52.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_52 D52 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D52.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D52.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D52.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D52.BASLANGIC, D52.BITIS)
      END >= 2

UNION ALL

SELECT 53 AS ISTASYON, 
       D53.BASLANGIC, 
       D53.BITIS, 
       CASE 
           WHEN D53.BITIS IS NULL THEN 
               DATEDIFF(MINUTE, D53.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
           ELSE 
               DATEDIFF(MINUTE, D53.BASLANGIC, D53.BITIS)
       END AS SURE_DAKIKA,
       COALESCE(DK.TANIMI, 'TANIMSIZ') AS TANIMI, 
       D53.DISPLINEREF
FROM dbo.DT_URTVT_DURUS_53 D53 WITH (NOLOCK)
LEFT OUTER JOIN dbo.DT_URTVT_DURUSKODLARI DK WITH (NOLOCK)
    ON D53.DURUSREF = DK.LOGICALREF
WHERE CASE 
          WHEN D53.BITIS IS NULL THEN 
              DATEDIFF(MINUTE, D53.BASLANGIC, CAST(GETUTCDATE() AT TIME ZONE 'Turkey Standard Time' AS DATETIME))
          ELSE 
              DATEDIFF(MINUTE, D53.BASLANGIC, D53.BITIS)
      END >= 2