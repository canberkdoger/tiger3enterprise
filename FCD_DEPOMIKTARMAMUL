SELECT  I.CODE AS [MALZEME KODU], 
        I.NAME AS [MALZEME ADI], 
        I.SPECODE3 AS [KALIP KODU],
        SP.DEFINITION_ AS [KALIP ADI],
        SUM(CASE WHEN ST.INVENNO = -1 THEN ST.ONHAND ELSE 0 END) AS [TOPLAM MİKTAR],
        SUM(CASE WHEN ST.INVENNO = 0 THEN ST.ONHAND ELSE 0 END) AS [B. Merkez],
        SUM(CASE WHEN ST.INVENNO = 1 THEN ST.ONHAND ELSE 0 END) AS [B. Üretim],
        SUM(CASE WHEN ST.INVENNO = 2 THEN ST.ONHAND ELSE 0 END) AS [B. İade Ambarı],
        SUM(CASE WHEN ST.INVENNO = 3 THEN ST.ONHAND ELSE 0 END) AS [B. Karantina Depo],
        SUM(CASE WHEN ST.INVENNO = 4 THEN ST.ONHAND ELSE 0 END) AS [Erport Antrepo],
        SUM(CASE WHEN ST.INVENNO = 5 THEN ST.ONHAND ELSE 0 END) AS [Goker Antrepo],
        SUM(CASE WHEN ST.INVENNO = 6 THEN ST.ONHAND ELSE 0 END) AS [Aktas Paketleme],
        SUM(CASE WHEN ST.INVENNO = 7 THEN ST.ONHAND ELSE 0 END) AS [S. Merkez],
        SUM(CASE WHEN ST.INVENNO = 8 THEN ST.ONHAND ELSE 0 END) AS [S. Üretim],
        SUM(CASE WHEN ST.INVENNO = 9 THEN ST.ONHAND ELSE 0 END) AS [B. Giriş Kalite Kontrol],
        SUM(CASE WHEN ST.INVENNO = 10 THEN ST.ONHAND ELSE 0 END) AS [S. Giriş Kalite Kontrol],
        SUM(CASE WHEN ST.INVENNO = 11 THEN ST.ONHAND ELSE 0 END) AS [S. İade Ambarı],
        SUM(CASE WHEN ST.INVENNO = 12 THEN ST.ONHAND ELSE 0 END) AS [S. Karantina Depo],
        SUM(CASE WHEN ST.INVENNO = 13 THEN ST.ONHAND ELSE 0 END) AS [B.Teknik Malzeme],
        SUM(CASE WHEN ST.INVENNO = 14 THEN ST.ONHAND ELSE 0 END) AS [S.Teknik Malzeme],
        SUM(CASE WHEN ST.INVENNO = 15 THEN ST.ONHAND ELSE 0 END) AS [S.Teknik Malzeme]
FROM    dbo.LG_125_ITEMS I 
        LEFT JOIN dbo.LV_125_01_STINVTOT ST ON I.LOGICALREF = ST.STOCKREF 
        LEFT JOIN dbo.LG_125_SPECODES SP ON I.SPECODE3 = SP.SPECODE
WHERE   I.CARDTYPE = 12 AND ST.INVENNO <= 15
GROUP BY I.CODE, I.NAME, I.SPECODE3, SP.DEFINITION_
HAVING  SUM(CASE WHEN ST.INVENNO = -1 THEN ST.ONHAND ELSE 0 END) > 0;