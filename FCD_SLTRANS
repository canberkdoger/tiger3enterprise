SELECT
    '125' AS Firma,
    '01' AS Donem,
    CASE [SLTRANS].[SLTYPE]
        WHEN 1 THEN 'Lot'
        WHEN 2 THEN 'Seri'
        ELSE 'Ne Oldugu Belirsiz'
    END AS [Seri Lot Türü],
    ITEMS.CARDTYPE AS Kart_Turu,
    SERILOTN.CODE AS [Seri Lot Kodu],
    SERILOTN.NAME AS [Seri Lot Adı],
    ITEMS.CODE AS [Malzeme Kodu],
    ITEMS.NAME AS [Malzeme Adi],
    STFICHE.FICHENO AS FIS_NO,
    CLCARD.CODE AS [Müşteri Kodu],
    CLCARD.DEFINITION_ AS [Müşteri Ünvanı],
    SLTRANS.DATE_ AS [Hareket Tarihi],
    SLTRANS.EXPDATE AS [Son Kullanma Tarihi],
    SLTRANS.SPECODE AS [Palet No],
    CASE SLTRANS.IOCODE
        WHEN 1 THEN 'Giriş'
        WHEN 2 THEN 'Ambar Girişi'
        WHEN 3 THEN 'Ambar Çıkışı'
        WHEN 4 THEN 'Çıkış'
        ELSE 'Tanımsız'
    END AS [Giris Cikis Kodu],
    CASE STFICHE.FROMTRANSFER
        WHEN 0 THEN 'NORMAL'
        WHEN 1 THEN 'VİRMAN'
    END AS TIPI,
    (CASE
        WHEN SLTRANS.UINFO1 = 0 THEN 0
        ELSE ((SLTRANS.AMOUNT / NULLIF(SLTRANS.UINFO1, 0)) * SLTRANS.UINFO2) * (CASE WHEN SLTRANS.IOCODE IN (1, 2) THEN 1 ELSE -1 END)
    END) AS ANABIRIM_MIKTAR,
    SLTRANS.AMOUNT AS MIKTAR,
    UNITSETL.CODE AS [HareketBirim Kodu],
    STLINE.UINFO1 AS [Cevrim Katsayisi1],
    STLINE.UINFO2 AS [Cevrim Katsayisi2],
    (CASE
        WHEN SLTRANS.UINFO1 = 0 OR A.CONVFACT1 = 0 THEN 0
        WHEN SLTRANS.UINFO2 = 0 OR A.CONVFACT2 = 0 THEN 0
        WHEN STLINE.STOCKREF = A.ITEMREF AND STLINE.UOMREF = A.UNITLINEREF THEN SLTRANS.UINFO1
        ELSE ISNULL((SLTRANS.UINFO2 / NULLIF(SLTRANS.UINFO1, 0)) * SLTRANS.AMOUNT / (NULLIF(A.CONVFACT2, 0) / NULLIF(A.CONVFACT1, 0)), 0)
    END) * (CASE WHEN SLTRANS.IOCODE IN (3, 4) THEN -1 ELSE 1 END) AS BIRINCI_BIRIM,
    D.CODE AS BIRIM_1,
    (CASE
        WHEN SLTRANS.UINFO1 = 0 OR B.CONVFACT1 = 0 THEN 0
        WHEN SLTRANS.UINFO2 = 0 OR B.CONVFACT2 = 0 THEN 0
        WHEN STLINE.STOCKREF = B.ITEMREF AND STLINE.UOMREF = B.UNITLINEREF THEN SLTRANS.UINFO1
        ELSE ISNULL((SLTRANS.UINFO2 / NULLIF(SLTRANS.UINFO1, 0)) * SLTRANS.AMOUNT / (NULLIF(B.CONVFACT2, 0) / NULLIF(B.CONVFACT1, 0)), 0)
    END) * (CASE WHEN SLTRANS.IOCODE IN (3, 4) THEN -1 ELSE 1 END) AS IKINCI_BIRIM,
    C.CODE AS BIRIM_2,
    (CASE
        WHEN SLTRANS.UINFO1 = 0 OR E.CONVFACT1 = 0 THEN 0
        WHEN SLTRANS.UINFO2 = 0 OR E.CONVFACT2 = 0 THEN 0
        WHEN STLINE.STOCKREF = E.ITEMREF AND STLINE.UOMREF = E.UNITLINEREF THEN SLTRANS.UINFO1
        ELSE ISNULL((SLTRANS.UINFO2 / NULLIF(SLTRANS.UINFO1, 0)) * SLTRANS.AMOUNT / (NULLIF(E.CONVFACT2, 0) / NULLIF(E.CONVFACT1, 0)), 0)
    END) * (CASE WHEN SLTRANS.IOCODE IN (3, 4) THEN -1 ELSE 1 END) AS UCUNCU_BIRIM,
    F.CODE AS BIRIM_3,
    CASE
        WHEN SLTRANS.UINFO1 = 0 OR B.CONVFACT1 = 0 OR A.CONVFACT1 = 0 THEN 0
        WHEN D.CODE = 'KG' THEN (SLTRANS.UINFO2 / NULLIF(SLTRANS.UINFO1, 0)) * SLTRANS.AMOUNT / (NULLIF(A.CONVFACT2, 0) / NULLIF(A.CONVFACT1, 0))
        ELSE ISNULL((SLTRANS.UINFO2 / NULLIF(SLTRANS.UINFO1, 0)) * SLTRANS.AMOUNT / (NULLIF(B.CONVFACT2, 0) / NULLIF(B.CONVFACT1, 0)), 0)
    END AS KG_MIKTAR,
    SLTRANS.INVENNO AS [Ambar No],
    SLTRANS.FICHETYPE AS [Stok Fis Turu No],
    '' AS [Islem Turu],
    LOCATION.CODE AS [Stok Yeri Kodu],
    STLINE.ADDTAXRATE AS [ÖTV Oranı],
    STLINE.ADDTAXCONVFACT AS [ÖTV TUTAR],
    STLINE.ADDTAXAMOUNT AS [Hesaplanan ÖTV],
    STLINE.ADDTAXPRCOST AS [ÖTV Maliyet Tutarı],
    STLINE.ADDTAXRETCOST AS [ÖTV İade Maliyeti],
    STLINE.ADDTAXRETCOSTCURR AS [ÖTV raporlama Dövizi Tutarı],
    SLTRANS.RATESCORE AS [Not],
    CASE SLTRANS.CANCELLED
        WHEN 0 THEN 'Hayir'
        WHEN 1 THEN 'Evet'
        ELSE 'Ne Oldugu Belirsiz'
    END AS [Iptal Edilmis],
    SLTRANS.OUTCOST AS [Cikis Fisleri Cikis Maliyeti],
    SLTRANS.OUTCOSTCURR AS [Cikis Fisleri Dovizli Cikis Maliyeti],
    SLTRANS.DIFFPRCOST AS [Fiyat Farki Nedeniyle Olusan Maliyet],
    SLTRANS.DIFFPRCOSTCURR AS [Fiyat Farki Nedeniyle Olusan Dovizli Maliyet],
    CASE [SLTRANS].[LPRODSTAT]
        WHEN 0 THEN 'Güncel'
        WHEN 1 THEN 'Planlanan'
        ELSE 'Ne Oldugu Belirsiz'
    END AS Durumu,
    CASE [SLTRANS].[SOURCETYPE]
        WHEN 1 THEN 'Ambar'
        WHEN 2 THEN 'Is Istasyonu'
        ELSE 'Ne Oldugu Belirsiz'
    END AS [Kaynak Türü],
    SLTRANS.UOMREF AS [Birim Ref],
    SLTRANS.LOCREF AS [Stok Yeri Ref],
    SLTRANS.SLREF AS [Seri Lot Kaydi Ref],
    SLTRANS.SOURCEWSREF AS [Kaynak Is Ist Ref],
    WORKSTAT.CODE AS [Kaynak Is Ist Kodu],
    SLTRANS.LINENR AS [Satir No],
    SLTRANS.LOGICALREF AS [Dosya Adresi],
    SLTRANS.STFICHEREF AS [Stok Fisi Adresi],
    SLTRANS.STTRANSREF AS [Stok Hareketi Ref],
    SLTRANS.INTRANSREF AS [Giris Stok Hareketi Ref],
    SLTRANS.INSLTRANSREF AS [Giris Seri Lot Yerlesim Hareketi Ref],
    SLTRANS.ITEMREF AS [Malzeme Karti Ref],
    STFICHE.FICHENO AS Fisno,
    STLINE.LINEEXP AS [Satir Aciklamasi],
    SLTRANS.AMOUNT * (CASE WHEN SLTRANS.IOCODE IN (3, 4) THEN -1 ELSE 1 END) AS [Net Miktar],
    VARIANT.CODE AS VARYANT_KODU,
    VARIANT.NAME AS VARYANT_ADI,
    CLCARD.CODE AS [CH Kodu],
    CLCARD.DEFINITION_ AS [CH Unvani],
    ITEMS.CODE AS [Stok Kodu],
    ITEMS.NAME AS [Stok Adi]
FROM dbo.LG_125_01_SLTRANS AS SLTRANS WITH (NOLOCK)
LEFT OUTER JOIN dbo.LG_125_ITEMS AS ITEMS WITH (NOLOCK) ON SLTRANS.ITEMREF = ITEMS.LOGICALREF
LEFT OUTER JOIN dbo.LG_125_01_SERILOTN AS SERILOTN WITH (NOLOCK) ON SLTRANS.SLREF = SERILOTN.LOGICALREF
LEFT OUTER JOIN dbo.LG_125_LOCATION AS LOCATION WITH (NOLOCK) ON SLTRANS.LOCREF = LOCATION.LOGICALREF
LEFT OUTER JOIN dbo.LG_125_UNITSETL AS UNITSETL WITH (NOLOCK) ON SLTRANS.UOMREF = UNITSETL.LOGICALREF
LEFT OUTER JOIN dbo.LG_125_WORKSTAT AS WORKSTAT WITH (NOLOCK) ON SLTRANS.SOURCEWSREF = WORKSTAT.LOGICALREF
LEFT OUTER JOIN dbo.LG_125_01_STFICHE AS STFICHE WITH (NOLOCK) ON SLTRANS.STFICHEREF = STFICHE.LOGICALREF
LEFT OUTER JOIN dbo.LG_125_CLCARD AS CLCARD WITH (NOLOCK) ON CLCARD.LOGICALREF = STFICHE.CLIENTREF
LEFT OUTER JOIN dbo.LG_125_01_STLINE AS STLINE WITH (NOLOCK) ON SLTRANS.STTRANSREF = STLINE.LOGICALREF
LEFT OUTER JOIN dbo.LG_125_UNITSETF AS SETF WITH (NOLOCK) ON STLINE.USREF = SETF.LOGICALREF
LEFT OUTER JOIN dbo.LG_125_UNITSETL AS D WITH (NOLOCK) ON D.UNITSETREF = SETF.LOGICALREF AND D.LINENR = 1
LEFT OUTER JOIN dbo.LG_125_UNITSETL AS C WITH (NOLOCK) ON C.UNITSETREF = SETF.LOGICALREF AND C.LINENR = 2
LEFT OUTER JOIN dbo.LG_125_UNITSETL AS F WITH (NOLOCK) ON F.UNITSETREF = SETF.LOGICALREF AND F.LINENR = 3
LEFT OUTER JOIN dbo.LG_125_ITMUNITA AS A WITH (NOLOCK) ON A.ITEMREF = SLTRANS.ITEMREF AND A.UNITLINEREF = D.LOGICALREF AND A.LINENR = 1 AND A.VARIANTREF = SLTRANS.VARIANTREF
LEFT OUTER JOIN dbo.LG_125_ITMUNITA AS B WITH (NOLOCK) ON B.ITEMREF = SLTRANS.ITEMREF AND B.UNITLINEREF = C.LOGICALREF AND B.LINENR = 2
LEFT OUTER JOIN dbo.LG_125_ITMUNITA AS E WITH (NOLOCK) ON E.ITEMREF = SLTRANS.ITEMREF AND E.UNITLINEREF = F.LOGICALREF AND E.LINENR = 3
LEFT OUTER JOIN dbo.LG_125_VARIANT AS VARIANT WITH (NOLOCK) ON VARIANT.LOGICALREF = SLTRANS.VARIANTREF